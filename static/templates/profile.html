<div ng-include="'/static/templates/alerts.html'"/>

<div ng-show="vm.account">
    <div class="row">
        <div class="col-md-6">
            <spam class="h2">{{ vm.account.persona_name }}</spam>
            <img ng-src="{{ vm.account.url_avatar }}">
        </div>
        <div class="col-md-6" ng-show=" vm.account.matches_download_required ">
            <alert type="success">The games are being downloaded automatically!</alert>
        </div>
        <div class="col-md-6" ng-show="!vm.account.matches_download_required ">
            <form ng-if="!vm.account.matches_download_required" ng-submit="vm.downloadGames()">
                <button type="submit" class="btn btn-primary">Download games</button>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <h4 ng-if="vm.matches.length">Matches</h4>

            <div ng-repeat="match in vm.matches">

                <div ng-repeat="player in match.radiant_team.concat(match.dire_team)"
                     ng-if="player.player_account.account_id == vm.accountId">
                    <div class="row">
                        <div class="col-md-2">
                            <img ng-src="{{ player.hero.url_small_portrait }}">
                        </div>
                        <div class="col-md-2">
                            <a ng-href="matches/{{ match.match_id }}">
                                <spam class="h5">{{ player.hero.localized_name }}</spam>
                            </a><br />
                            <spam class="h6">{{ match.game_mode.name }}</spam>

                        </div>
                        <div class="col-md-2">
                            {{ player.kills + '/' + player.deaths + '/' + player.assists }}
                        </div>
                        <div class="col-md-2">
                            <span ng-if="match.match_won" class="label label-success">Victory</span>
                            <span ng-if="!match.match_won" class="label label-danger">Loss</span>
                        </div>
                    </div>
                </div>

            </div>

        </div>


        <div class="col-md-4 friends-matches">
            <table class="table">
                <thead>
                <tr>
                    <td>Friend</td>
                    <td>Matches</td>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="f in vm.account.friends">
                    <td>
                        <img ng-src="{{ f.url_avatar }}">
                        <a href="profiles/{{ f.account_id }}">{{ f.persona_name }}</a>
                    </td>
                    <td>
                        <a href="friends/{{ vm.account.account_id + ',' + f.account_id }}">{{ f.qtd }}</a>
                    </td>
                </tr>
                </tbody>
            </table>

        </div>
    </div>


    <div class="row">
        <div class="col-md-6">
            <h3>Reports created</h3>
            <report ng-repeat="report in vm.account.reports_created" report="report" mode="'created'" />
        </div>
        <div class="col-md-6">
            <h3>Reports received</h3>
            <report ng-repeat="report in vm.account.reports_received" report="report" mode="'received'" />
        </div>
    </div>
</div>